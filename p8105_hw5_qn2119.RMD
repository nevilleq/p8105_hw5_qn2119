---
title: "P8105 Homework 5"
author: "Quinton Neville"
date: "November 6, 2018"
header-includes: 
  \usepackage{graphicx}
  \usepackage{float}
  \usepackage{amsmath}
output:
   github_document
---

```{r setup, echo = FALSE, warning = FALSE, message = FALSE}
#Load necessary packages
library(tidyverse)
library(readxl)
library(readr)
library(p8105.datasets)
library(patchwork)
library(ggridges)
library(gridExtra)
library(shiny)
library(plotly)
library(broom)
library(scales)
library(purrr)
library(koRpus)

#Controlling figure output in markdown
knitr::opts_chunk$set(
#  fig.height =   
  fig.width = 6,
#  fig.asp = .5,
  out.width = "90%",
#  out.height = 
 fig.align = "center",
  cache = FALSE
)

#Set Theme for ggplot2
theme_set(theme_bw() + theme(plot.title = element_text(hjust = 0.5), legend.position = "bottom"))

#Set Scientific notation output for knitr
options(scipen = 999999)

```

#Problem 1

```{r problem_1, warning = FALSE, message = FALSE}
data.csv.path <- list.files(path = "./data") 

read.p1.data <- function(data.csv.path){
  read_csv(paste0("./data/", data.csv.path)) %>%
  gather(key = week, value = observation) %>%
  mutate(
    week = week %>% substring(., 6) %>% as.numeric(),
    id = data.csv.path %>% rep(., length = length(week)) %>% extract_numeric(),
    group = data.csv.path %>% rep(., length = length(week)) %>% stringr::str_extract(., "[a-z][a-z][a-z]")
  ) %>%
  select(id, week, group, everything())
}

p1.df <- purrr::map_df(data.csv.path, read.p1.data) %>%
  mutate(group = group %>% as.factor() %>% forcats::fct_recode(., "Control" = "con", "Experimental" = "exp"))

str(p1.df)
```





#Problem 2